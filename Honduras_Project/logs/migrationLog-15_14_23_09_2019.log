2019-09-23 15:14:10,471 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:13,506 - root - INFO - Connections to database severed
2019-09-23 15:14:13,558 - root - INFO - database dropped
2019-09-23 15:14:13,564 - root - INFO - user ready
2019-09-23 15:14:13,565 - root - INFO - access granted
2019-09-23 15:14:13,566 - root - INFO - access granted
2019-09-23 15:14:13,566 - root - INFO - password changed
2019-09-23 15:14:14,285 - root - INFO - <_io.TextIOWrapper name='<stderr>' mode='w' encoding='UTF-8'>Child returned, 0
2019-09-23 15:14:14,299 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:14,327 - root - INFO - repository synced
2019-09-23 15:14:14,333 - root - INFO - repository synced
2019-09-23 15:14:14,338 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:14,604 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:14,625 - root - WARNING - creating views.
2019-09-23 15:14:14,631 - root - INFO - wrong query:CREATE VIEW dbo.vw_marcas2 AS  with cte as (SELECT cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ, 'M' FILE_TYPE,   cast(left(nro_solici,4)  as numeric (4,0)) FILE_SERIES,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0)) FILE_NBR,cast(0 as numeric) ind_import, 'MAR' application_type, case when TIPO_MARCA is not null then tipo_marca else 'MF' end application_subtype, cast(1 as numeric) law_code,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 		FILING_DATE,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 	 RECEPTION_DATE, PUBLICADA   PUBLICATION_DATE,  cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else 1 end as numeric(1,0)) ind_registered,   cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when (ISNUMERIC(REGISTRO)=0) then right(REGISTRO,1) else '1' end end as varchar) registration_type ,    case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else  case when registrada is not null then year(registrada) else 1900 end end  registration_series,    case    when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null   when  isnumeric(registro)=1 then registro else Replace(REGISTRO, Substring(REGISTRO, PatIndex('%[^0-9.-]%', REGISTRO), 1), '') end				   registration_nbr,		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when registrada is null then cast('1900-01-01' as date) else registrada end end registration_date,		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then registrada				when renueva is null then case when datediff(year, registrada, expira) >10 then dateadd(year,-10,expira) else REGISTRADA end				else renueva end end entitlement_date,		   		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then dateadd(year,10,registrada)				when expira is null then dateadd(year,10,renueva)				else expira end end expiration_date,	  SIGNO sign_type,   NOM_MARCA mark_name,    case when RESERVA is not null then 'RESERVA: '+cast(RESERVA as varchar(max)) else '' end +   case when LIMITACION is not null and len(LIMITACION)>0 then 'LIMITACION: ' + cast(LIMITACION as varchar(3000)) else '' end notes,      case when (len(rtomo)>0) then 'Tomo: ' + cast(rtomo as varchar) + ' -- ' else '' end  tomo,   case when len(rfolio)>0 then 'Folio: ' + cast(rfolio as varchar) + ' -- ' else '' end folio,   case when len(NRO_RESOL)>0 then 'Resolucion: ' + cast(NRO_RESOL as varchar) + ' -- ' else '' end nro_resoluc,        4 as capture_user_id,     getdate() as capture_date, rowNum,NRO_SOLICI ,   RN = ROW_NUMBER()OVER(PARTITION BY cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar),   cast(left(NRO_SOLICI,4) as numeric(4,0)) ,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0))    ORDER BY nro_solici)  	   FROM dbo.vw_origin_marca    where Deleted='N' and len(nro_solici)>5       )   select case when rn>1 then file_SEQ + cast(rn as varchar) else file_seq end file_SEQ      ,FILE_TYPE      ,FILE_SERIES      ,file_NBR      ,ind_import      ,application_type      ,application_subtype      ,law_code      ,FILING_DATE      ,RECEPTION_DATE      ,PUBLICATION_DATE      ,ind_registered      ,registration_type      ,registration_series      ,registration_nbr     ,REGISTRAtion_date    ,entitlement_date   ,expiration_date      ,sign_type      ,mark_name      ,notes      ,tomo,folio,nro_resoluc,notas_resolucion      ,capture_user_id      ,capture_date      ,rowNum      ,NRO_SOLICI      ,RN from cte  running statementCREATE VIEW dbo.vw_marcas2 AS  with cte as (SELECT cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ, 'M' FILE_TYPE,   cast(left(nro_solici,4)  as numeric (4,0)) FILE_SERIES,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0)) FILE_NBR,cast(0 as numeric) ind_import, 'MAR' application_type, case when TIPO_MARCA is not null then tipo_marca else 'MF' end application_subtype, cast(1 as numeric) law_code,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 		FILING_DATE,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 	 RECEPTION_DATE, PUBLICADA   PUBLICATION_DATE,  cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else 1 end as numeric(1,0)) ind_registered,   cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when (ISNUMERIC(REGISTRO)=0) then right(REGISTRO,1) else '1' end end as varchar) registration_type ,    case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else  case when registrada is not null then year(registrada) else 1900 end end  registration_series,    case    when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null   when  isnumeric(registro)=1 then registro else Replace(REGISTRO, Substring(REGISTRO, PatIndex('%[^0-9.-]%', REGISTRO), 1), '') end				   registration_nbr,		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when registrada is null then cast('1900-01-01' as date) else registrada end end registration_date,		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then registrada				when renueva is null then case when datediff(year, registrada, expira) >10 then dateadd(year,-10,expira) else REGISTRADA end				else renueva end end entitlement_date,		   		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then dateadd(year,10,registrada)				when expira is null then dateadd(year,10,renueva)				else expira end end expiration_date,	  SIGNO sign_type,   NOM_MARCA mark_name,    case when RESERVA is not null then 'RESERVA: '+cast(RESERVA as varchar(max)) else '' end +   case when LIMITACION is not null and len(LIMITACION)>0 then 'LIMITACION: ' + cast(LIMITACION as varchar(3000)) else '' end notes,      case when (len(rtomo)>0) then 'Tomo: ' + cast(rtomo as varchar) + ' -- ' else '' end  tomo,   case when len(rfolio)>0 then 'Folio: ' + cast(rfolio as varchar) + ' -- ' else '' end folio,   case when len(NRO_RESOL)>0 then 'Resolucion: ' + cast(NRO_RESOL as varchar) + ' -- ' else '' end nro_resoluc,        4 as capture_user_id,     getdate() as capture_date, rowNum,NRO_SOLICI ,   RN = ROW_NUMBER()OVER(PARTITION BY cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar),   cast(left(NRO_SOLICI,4) as numeric(4,0)) ,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0))    ORDER BY nro_solici)  	   FROM dbo.vw_origin_marca    where Deleted='N' and len(nro_solici)>5       )   select case when rn>1 then file_SEQ + cast(rn as varchar) else file_seq end file_SEQ      ,FILE_TYPE      ,FILE_SERIES      ,file_NBR      ,ind_import      ,application_type      ,application_subtype      ,law_code      ,FILING_DATE      ,RECEPTION_DATE      ,PUBLICATION_DATE      ,ind_registered      ,registration_type      ,registration_series      ,registration_nbr     ,REGISTRAtion_date    ,entitlement_date   ,expiration_date      ,sign_type      ,mark_name      ,notes      ,tomo,folio,nro_resoluc,notas_resolucion      ,capture_user_id      ,capture_date      ,rowNum      ,NRO_SOLICI      ,RN from cte  
2019-09-23 15:14:14,631 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'notas_resolucion'. (207) (SQLExecDirectW)")
2019-09-23 15:14:14,661 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:14,664 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:14,664 - root - WARNING - starting migration to intermed.
2019-09-23 15:14:14,811 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT
2019-09-23 15:14:17,562 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT_PERSONS
2019-09-23 15:14:36,036 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:36,041 - root - INFO - Connections to database severed
2019-09-23 15:14:36,083 - root - INFO - database dropped
2019-09-23 15:14:36,085 - root - INFO - user ready
2019-09-23 15:14:36,086 - root - INFO - access granted
2019-09-23 15:14:36,086 - root - INFO - access granted
2019-09-23 15:14:36,087 - root - INFO - password changed
2019-09-23 15:14:36,798 - root - INFO - <_io.TextIOWrapper name='<stderr>' mode='w' encoding='UTF-8'>Child returned, 0
2019-09-23 15:14:36,811 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:36,839 - root - INFO - repository synced
2019-09-23 15:14:36,846 - root - INFO - repository synced
2019-09-23 15:14:36,850 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:37,103 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:37,119 - root - WARNING - creating views.
2019-09-23 15:14:37,151 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:37,154 - root - WARNING - connected to Sqlserver.
2019-09-23 15:14:37,154 - root - WARNING - starting migration to intermed.
2019-09-23 15:14:37,225 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT
2019-09-23 15:14:39,926 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT_PERSONS
2019-09-23 15:15:03,949 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK
2019-09-23 15:17:03,638 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK_ACTIONS
2019-09-23 15:29:02,334 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK_NICE_CLASSES
2019-09-23 15:30:15,470 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK_OWNERS
2019-09-23 15:31:41,833 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK_PRIORITIES
2019-09-23 15:31:44,228 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK_REPRS
2019-09-23 15:32:47,412 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK_VIENNA_CLASSES
2019-09-23 15:32:54,697 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_USERDOC
2019-09-23 15:34:34,743 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_USERDOC_ACTIONS
2019-09-23 15:34:46,607 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_USERDOC_FILES
2019-09-23 15:41:14,493 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_USERDOC_OWNERS
2019-09-23 15:41:52,076 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_USERDOC_REPRS
