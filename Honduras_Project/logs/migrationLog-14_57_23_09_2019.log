2019-09-23 14:57:41,923 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:41,927 - root - INFO - Connections to database severed
2019-09-23 14:57:41,970 - root - INFO - database dropped
2019-09-23 14:57:41,971 - root - INFO - user ready
2019-09-23 14:57:41,972 - root - INFO - access granted
2019-09-23 14:57:41,973 - root - INFO - access granted
2019-09-23 14:57:41,974 - root - INFO - password changed
2019-09-23 14:57:42,712 - root - INFO - <_io.TextIOWrapper name='<stderr>' mode='w' encoding='UTF-8'>Child returned, 0
2019-09-23 14:57:42,725 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:42,754 - root - INFO - repository synced
2019-09-23 14:57:42,760 - root - INFO - repository synced
2019-09-23 14:57:42,766 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:43,020 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:43,040 - root - WARNING - creating views.
2019-09-23 14:57:43,046 - root - INFO - wrong query:CREATE VIEW dbo.vw_marcas2 AS  with cte as (SELECT cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ, 'M' FILE_TYPE,   cast(left(nro_solici,4)  as numeric (4,0)) FILE_SERIES,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0)) FILE_NBR,cast(0 as numeric) ind_import, 'MAR' application_type, case when TIPO_MARCA is not null then tipo_marca else 'MF' end application_subtype, cast(1 as numeric) law_code,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 		FILING_DATE,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 	 RECEPTION_DATE, PUBLICADA   PUBLICATION_DATE,  cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else 1 end as numeric(1,0)) ind_registered,   cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when (ISNUMERIC(REGISTRO)=0) then right(REGISTRO,1) else '1' end end as varchar) registration_type ,    case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else  case when registrada is not null then year(registrada) else 1900 end end  registration_series,    case    when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null   when  isnumeric(registro)=1 then registro else Replace(REGISTRO, Substring(REGISTRO, PatIndex('%[^0-9.-]%', REGISTRO), 1), '') end				   registration_nbr,		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when registrada is null then cast('1900-01-01' as date) else registrada end end registration_date,		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then registrada				when renueva is null then case when datediff(year, registrada, expira) >10 then dateadd(year,-10,expira) else REGISTRADA end				else renueva end end entitlement_date,		   		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then dateadd(year,10,registrada)				when expira is null then dateadd(year,10,renueva)				else expira end end expiration_date,	  SIGNO sign_type,   NOM_MARCA mark_name,    cast(RESERVA as varchar(max)) notes,      (case when (len(rtomo)>0) then 'Tomo: ' + cast(rtomo as varchar) + ' -- ' else '' end ) tomo,   (case when len(rfolio)>0 then 'Folio: ' + cast(rfolio as varchar) + ' -- ' else '' end) folio,   (case when len(NRO_RESOL)>0 then 'Resolucion: ' + cast(NRO_RESOL as varchar) + ' -- ' else '' end) nro_resoluc,   (case when (len(LIMITACION)>0) then 'Reserva: ' + cast(LIMITACION as varchar(3000)) else '' end)  notas_resolucion,     4 as capture_user_id,     getdate() as capture_date, rowNum,NRO_SOLICI ,   RN = ROW_NUMBER()OVER(PARTITION BY cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar),   cast(left(NRO_SOLICI,4) as numeric(4,0)) ,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0))    ORDER BY nro_solici)  	   FROM dbo.vw_origin_marca    where Deleted='N' and len(nro_solici)>5       )   select case when rn>1 then file_SEQ + cast(rn as varchar) else file_seq end file_SEQ      ,FILE_TYPE      ,FILE_SERIES      ,file_NBR      ,ind_import      ,application_type      ,application_subtype      ,law_code      ,FILING_DATE      ,RECEPTION_DATE      ,PUBLICATION_DATE      ,ind_registered      ,registration_type      ,registration_series      ,registration_nbr     ,REGISTRAtion_date    ,entitlement_date   ,expiration_date      ,sign_type      ,mark_name      ,notes      ,tomo,folio,nro_resoluv,notas_resolucion      ,capture_user_id      ,capture_date      ,rowNum      ,NRO_SOLICI      ,RN from cte  running statementCREATE VIEW dbo.vw_marcas2 AS  with cte as (SELECT cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ, 'M' FILE_TYPE,   cast(left(nro_solici,4)  as numeric (4,0)) FILE_SERIES,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0)) FILE_NBR,cast(0 as numeric) ind_import, 'MAR' application_type, case when TIPO_MARCA is not null then tipo_marca else 'MF' end application_subtype, cast(1 as numeric) law_code,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 		FILING_DATE,case when solicitada is null then cast('1900-01-01' as datetime) else convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) end 	 RECEPTION_DATE, PUBLICADA   PUBLICATION_DATE,  cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else 1 end as numeric(1,0)) ind_registered,   cast(case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when (ISNUMERIC(REGISTRO)=0) then right(REGISTRO,1) else '1' end end as varchar) registration_type ,    case when (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else  case when registrada is not null then year(registrada) else 1900 end end  registration_series,    case    when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null   when  isnumeric(registro)=1 then registro else Replace(REGISTRO, Substring(REGISTRO, PatIndex('%[^0-9.-]%', REGISTRO), 1), '') end				   registration_nbr,		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else case when registrada is null then cast('1900-01-01' as date) else registrada end end registration_date,		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then registrada				when renueva is null then case when datediff(year, registrada, expira) >10 then dateadd(year,-10,expira) else REGISTRADA end				else renueva end end entitlement_date,		   		   		   case when  (registro is null or registro='0' or len(replace(registro,' ',''))=0) then null else		   case when registrada is null and expira is null and renueva is null then cast('1900-01-01' as date)				when expira is null and renueva is null then dateadd(year,10,registrada)				when expira is null then dateadd(year,10,renueva)				else expira end end expiration_date,	  SIGNO sign_type,   NOM_MARCA mark_name,    cast(RESERVA as varchar(max)) notes,      (case when (len(rtomo)>0) then 'Tomo: ' + cast(rtomo as varchar) + ' -- ' else '' end ) tomo,   (case when len(rfolio)>0 then 'Folio: ' + cast(rfolio as varchar) + ' -- ' else '' end) folio,   (case when len(NRO_RESOL)>0 then 'Resolucion: ' + cast(NRO_RESOL as varchar) + ' -- ' else '' end) nro_resoluc,   (case when (len(LIMITACION)>0) then 'Reserva: ' + cast(LIMITACION as varchar(3000)) else '' end)  notas_resolucion,     4 as capture_user_id,     getdate() as capture_date, rowNum,NRO_SOLICI ,   RN = ROW_NUMBER()OVER(PARTITION BY cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar),   cast(left(NRO_SOLICI,4) as numeric(4,0)) ,   cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0))    ORDER BY nro_solici)  	   FROM dbo.vw_origin_marca    where Deleted='N' and len(nro_solici)>5       )   select case when rn>1 then file_SEQ + cast(rn as varchar) else file_seq end file_SEQ      ,FILE_TYPE      ,FILE_SERIES      ,file_NBR      ,ind_import      ,application_type      ,application_subtype      ,law_code      ,FILING_DATE      ,RECEPTION_DATE      ,PUBLICATION_DATE      ,ind_registered      ,registration_type      ,registration_series      ,registration_nbr     ,REGISTRAtion_date    ,entitlement_date   ,expiration_date      ,sign_type      ,mark_name      ,notes      ,tomo,folio,nro_resoluv,notas_resolucion      ,capture_user_id      ,capture_date      ,rowNum      ,NRO_SOLICI      ,RN from cte  
2019-09-23 14:57:43,046 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'nro_resoluv'. (207) (SQLExecDirectW)")
2019-09-23 14:57:43,071 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:43,074 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:43,074 - root - WARNING - starting migration to intermed.
2019-09-23 14:57:43,130 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT
2019-09-23 14:57:45,974 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT_PERSONS
2019-09-23 14:57:56,679 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:56,684 - root - INFO - Connections to database severed
2019-09-23 14:57:56,728 - root - INFO - database dropped
2019-09-23 14:57:56,729 - root - INFO - user ready
2019-09-23 14:57:56,730 - root - INFO - access granted
2019-09-23 14:57:56,731 - root - INFO - access granted
2019-09-23 14:57:56,731 - root - INFO - password changed
2019-09-23 14:57:57,467 - root - INFO - <_io.TextIOWrapper name='<stderr>' mode='w' encoding='UTF-8'>Child returned, 0
2019-09-23 14:57:57,480 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:57,509 - root - INFO - repository synced
2019-09-23 14:57:57,515 - root - INFO - repository synced
2019-09-23 14:57:57,519 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:57,766 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:57,784 - root - WARNING - creating views.
2019-09-23 14:57:57,816 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:57,818 - root - WARNING - connected to Sqlserver.
2019-09-23 14:57:57,818 - root - WARNING - starting migration to intermed.
2019-09-23 14:57:57,858 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT
2019-09-23 14:58:00,615 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_AGENT_PERSONS
2019-09-23 14:58:03,559 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK
2019-09-23 14:59:47,237 - root - WARNING - Going to insert to table: HN_MARCAS.dbo.VW_IMPORT_MARK_ACTIONS
