2019-04-15 09:17:34,624 - root - WARNING - connected to Sqlserver.
2019-04-15 09:17:34,630 - root - WARNING - Updating original tables with correction script.
2019-04-15 09:17:34,696 - root - INFO - From SQLCMD: b'Msg 102, Level 15, State 1, Server WS538539, Line 1\r\n'
2019-04-15 09:17:34,696 - root - INFO - From SQLCMD: b"Incorrect syntax near '\\'.\r\n"
2019-04-15 09:17:34,705 - root - WARNING - Updating orignal tables with additional correction.
2019-04-15 09:17:44,267 - root - WARNING - Regenerating intermediate tables.
2019-04-15 09:17:44,499 - root - WARNING - creating views.
2019-04-15 09:17:44,516 - root - INFO - wrong query: create view dbo.vw_PETIREG as SELECT rowNum,NR create or alter view dbo.vw_PETIREG as  SELECT rowNum,NRO_SOLICI,NUM_SERIE,cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ,'M' FILE_TYPE, cast(left(nro_solici,4) as numeric(4,0)) file_ser, cast( substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)) as numeric(10,0))  FILE_NBR,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,Deleted FROM HN1.dbo.vw_origin_petireg where NRO_SOLICI is not null and num_serie is not null and isnumeric(left(nro_solici,4))=1union allSELECT  [rowNum],nro_solici,  	documento num_serie, 	cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ,'M' FILE_TYPE, left(nro_solici,4) file_ser, cast( substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)) as numeric(10,0))  FILE_NBR,	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,      [DELETED]   FROM [HN1].[dbo].[vw_origin_movimi] where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N'running statement create view dbo.vw_PETIREG as SELECT rowNum,NR create or alter view dbo.vw_PETIREG as  SELECT rowNum,NRO_SOLICI,NUM_SERIE,cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ,'M' FILE_TYPE, cast(left(nro_solici,4) as numeric(4,0)) file_ser, cast( substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)) as numeric(10,0))  FILE_NBR,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,Deleted FROM HN1.dbo.vw_origin_petireg where NRO_SOLICI is not null and num_serie is not null and isnumeric(left(nro_solici,4))=1union allSELECT  [rowNum],nro_solici,  	documento num_serie, 	cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ,'M' FILE_TYPE, left(nro_solici,4) file_ser, cast( substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)) as numeric(10,0))  FILE_NBR,	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,      [DELETED]   FROM [HN1].[dbo].[vw_origin_movimi] where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N'
2019-04-15 09:17:44,516 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near the keyword 'create'. (156) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]'CREATE VIEW' must be the first statement in a query batch. (111); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'allSELECT'. (102); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'doc_seq'. (102)")
2019-04-15 09:17:44,517 - root - INFO - wrong query:       create view  dbo.vw_PETICI as  SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,SOLICITADA,hora,case when tipo_peti='RN' then 'ESC007'when tipo_peti='FU' then 'ESC056'when tipo_peti='LU' then 'ESC057'when tipo_peti='TR' then 'ESC067'when tipo_peti='CN' then 'ESC069'when tipo_peti='CD' then 'ESC096'when tipo_peti='NU' then 'ESC013'when tipo_peti='CC' then 'ESC016'when tipo_peti='RH' then 'ESC094'else tipo_petiendTIPO_PETI,STATUS_RES,STAT_DESDE,AGENTE,CALIDAD,qUien,CUAL,NRO_RESOL,case when OBSERVACIO='None' then '' else OBSERVACIO end OBSERVACIO,LEY,cambrep,Deleted FROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union allSELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[F_EVENTO] solicitada	  ,[HORA]      ,case when evento='MO' then 'ESC099'when evento='US' then 'ESC061'when evento='DC' then 'ESC036'when evento='CO' then 'ESC012'when evento='CP' then 'ESC011'when evento='IP' then 'ESC063'when evento='DS' then 'ESC006'when evento='DO' then 'ESC022'when evento='PU' then 'ESC002'when evento='AP' then 'ESC003'when evento='EO' then 'ESC001'when evento='AI' then 'ESC090'when evento='RR' then 'ESC037'when evento='EL' then 'ESC030'when evento='MA' then 'ESC023'when evento='OT' then 'ESC066'when evento='PE' then 'ESC025'when evento='PP' then 'ESC085'when evento='C1' then 'ESC043'when evento='ST' then 'ESC021'when evento='DP' then 'ESC102'when evento='RM' then 'ESC104'when evento='CE' then 'ESC051'when evento='MS' then 'ESC074'when evento='SP' then 'ESC027'when evento='SC' then 'ESC041'when evento='EM' then 'ESC066'when evento='LE' then 'ESC106'when evento='CL' then 'ESC066'when evento='NU' then 'ESC013'when evento='CC' then 'ESC016'when evento='RH' then 'ESC094'else evento end TIPO_PETI      ,null status_res	  , null stat_desde	  ,null agente	  , null calidad	  ,null quien	  ,null cual	  ,null nro_resol	  ,[COMENTARIO] observacio      ,null ley, null cambrep      ,[DELETED]        FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N'running statement       create view  dbo.vw_PETICI as  SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,SOLICITADA,hora,case when tipo_peti='RN' then 'ESC007'when tipo_peti='FU' then 'ESC056'when tipo_peti='LU' then 'ESC057'when tipo_peti='TR' then 'ESC067'when tipo_peti='CN' then 'ESC069'when tipo_peti='CD' then 'ESC096'when tipo_peti='NU' then 'ESC013'when tipo_peti='CC' then 'ESC016'when tipo_peti='RH' then 'ESC094'else tipo_petiendTIPO_PETI,STATUS_RES,STAT_DESDE,AGENTE,CALIDAD,qUien,CUAL,NRO_RESOL,case when OBSERVACIO='None' then '' else OBSERVACIO end OBSERVACIO,LEY,cambrep,Deleted FROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union allSELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[F_EVENTO] solicitada	  ,[HORA]      ,case when evento='MO' then 'ESC099'when evento='US' then 'ESC061'when evento='DC' then 'ESC036'when evento='CO' then 'ESC012'when evento='CP' then 'ESC011'when evento='IP' then 'ESC063'when evento='DS' then 'ESC006'when evento='DO' then 'ESC022'when evento='PU' then 'ESC002'when evento='AP' then 'ESC003'when evento='EO' then 'ESC001'when evento='AI' then 'ESC090'when evento='RR' then 'ESC037'when evento='EL' then 'ESC030'when evento='MA' then 'ESC023'when evento='OT' then 'ESC066'when evento='PE' then 'ESC025'when evento='PP' then 'ESC085'when evento='C1' then 'ESC043'when evento='ST' then 'ESC021'when evento='DP' then 'ESC102'when evento='RM' then 'ESC104'when evento='CE' then 'ESC051'when evento='MS' then 'ESC074'when evento='SP' then 'ESC027'when evento='SC' then 'ESC041'when evento='EM' then 'ESC066'when evento='LE' then 'ESC106'when evento='CL' then 'ESC066'when evento='NU' then 'ESC013'when evento='CC' then 'ESC016'when evento='RH' then 'ESC094'else evento end TIPO_PETI      ,null status_res	  , null stat_desde	  ,null agente	  , null calidad	  ,null quien	  ,null cual	  ,null nro_resol	  ,[COMENTARIO] observacio      ,null ley, null cambrep      ,[DELETED]        FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N'
2019-04-15 09:17:44,517 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'OBSERVACIO'. (102); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'doc_seq'. (102); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'TIPO_PETI'. (102)")
2019-04-15 09:17:44,521 - root - INFO - wrong query:         create  view  dbo.vw_userdoc as with cte as (select aaa.[rowNum]      ,[doc_seq]      ,[doc_ser]      ,[doc_nbr]      ,aaa.[NUM_SERIE]	  ,0 as ind_import	  ,TIPO_PETI userdoc_TYPE	  ,1 as law_code      ,convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) FILING_DATE,convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) RECEPTION_DATE       ,case when isnumeric(NRO_RESOL)=1 then 'Nro. resolucion: '+ NRO_RESOL else '' end +          case when len(observacio)>0 then 'observaciones: '+ cast( OBSERVACIO as varchar(max)) else '' end  notes         , NOMBRE PERSON_NAME ,case when (pais is null or pais='') then 'HN' else  PAIS end NATIONALITY_COUNTRY_CODE ,case when(len( LUGAR)>2 and len(pais)=2 ) then pais when len(lugar)=2 then lugar else 'HN' end RESIDENCE_COUNTRY_CODE ,case when (direccion is null or direccion='') then 'Falta direccion' else  DIRECCION end ADDRESS_STREET ,4 capture_user_id ,getdate() capture_date, STATUS_RES, STAT_DESDE, AGENTE	  	  ,aaa.[Deleted] 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  	  	  from (SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,SOLICITADA,hora,case when tipo_peti='RN' then 'ESC007'when tipo_peti='FU' then 'ESC056'when tipo_peti='LU' then 'ESC057'when tipo_peti='TR' then 'ESC067'when tipo_peti='CN' then 'ESC069'when tipo_peti='CD' then 'ESC096'when tipo_peti='NU' then 'ESC013'when tipo_peti='CC' then 'ESC016'when tipo_peti='RH' then 'ESC094'else tipo_petiendTIPO_PETI,STATUS_RES,STAT_DESDE,AGENTE,CALIDAD,qUien,CUAL,NRO_RESOL,case when OBSERVACIO='None' then '' else OBSERVACIO end OBSERVACIO,LEY,cambrep,Deleted FROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union allSELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[F_EVENTO] solicitada	  ,[HORA]      ,case when evento='MO' then 'ESC099'when evento='US' then 'ESC061'when evento='DC' then 'ESC036'when evento='CO' then 'ESC012'when evento='CP' then 'ESC011'when evento='IP' then 'ESC063'when evento='DS' then 'ESC006'when evento='DO' then 'ESC022'when evento='PU' then 'ESC002'when evento='AP' then 'ESC003'when evento='EO' then 'ESC001'when evento='AI' then 'ESC090'when evento='RR' then 'ESC037'when evento='EL' then 'ESC030'when evento='MA' then 'ESC023'when evento='OT' then 'ESC066'when evento='PE' then 'ESC025'when evento='PP' then 'ESC085'when evento='C1' then 'ESC043'when evento='ST' then 'ESC021'when evento='DP' then 'ESC102'when evento='RM' then 'ESC104'when evento='CE' then 'ESC051'when evento='MS' then 'ESC074'when evento='SP' then 'ESC027'when evento='SC' then 'ESC041'when evento='EM' then 'ESC066'when evento='LE' then 'ESC106'when evento='CL' then 'ESC066'when evento='NU' then 'ESC013'when evento='CC' then 'ESC016'when evento='RH' then 'ESC094'else evento end TIPO_PETI      ,null status_res	  , null stat_desde	  ,null agente	  , null calidad	  ,null quien	  ,null cual	  ,null nro_resol	  ,[COMENTARIO] observacio      ,null ley, null cambrep      ,[DELETED]        FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N' ) aaa  left join HN1.dbo.vw_origin_nuenoms nom on aaa.num_serie=nom.NUM_SERIE left join  HN1.dbo.vw_origin_TITULAR titu on  nom.titular=titu.TITULAR   where aaa.num_serie is not null        )  select   case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq,  cast(doc_ser as numeric(4,0)) USERDOC_SERIES,  cast(doc_nbr as numeric(10,0)) USERDOC_NBR, IND_IMPORT      , USERDOC_TYPE, LAW_CODE, FILING_DATE, RECEPTION_DATE, NOTES, case when PERSON_NAME is null then 'falta capturar nombre' else person_name end person_name  , NATIONALITY_COUNTRY_CODE, RESIDENCE_COUNTRY_CODE      , ADDRESS_STREET, CAPTURE_USER_ID, CAPTURE_DATE from cte running statement         create  view  dbo.vw_userdoc as with cte as (select aaa.[rowNum]      ,[doc_seq]      ,[doc_ser]      ,[doc_nbr]      ,aaa.[NUM_SERIE]	  ,0 as ind_import	  ,TIPO_PETI userdoc_TYPE	  ,1 as law_code      ,convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) FILING_DATE,convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) RECEPTION_DATE       ,case when isnumeric(NRO_RESOL)=1 then 'Nro. resolucion: '+ NRO_RESOL else '' end +          case when len(observacio)>0 then 'observaciones: '+ cast( OBSERVACIO as varchar(max)) else '' end  notes         , NOMBRE PERSON_NAME ,case when (pais is null or pais='') then 'HN' else  PAIS end NATIONALITY_COUNTRY_CODE ,case when(len( LUGAR)>2 and len(pais)=2 ) then pais when len(lugar)=2 then lugar else 'HN' end RESIDENCE_COUNTRY_CODE ,case when (direccion is null or direccion='') then 'Falta direccion' else  DIRECCION end ADDRESS_STREET ,4 capture_user_id ,getdate() capture_date, STATUS_RES, STAT_DESDE, AGENTE	  	  ,aaa.[Deleted] 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  	  	  from (SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,SOLICITADA,hora,case when tipo_peti='RN' then 'ESC007'when tipo_peti='FU' then 'ESC056'when tipo_peti='LU' then 'ESC057'when tipo_peti='TR' then 'ESC067'when tipo_peti='CN' then 'ESC069'when tipo_peti='CD' then 'ESC096'when tipo_peti='NU' then 'ESC013'when tipo_peti='CC' then 'ESC016'when tipo_peti='RH' then 'ESC094'else tipo_petiendTIPO_PETI,STATUS_RES,STAT_DESDE,AGENTE,CALIDAD,qUien,CUAL,NRO_RESOL,case when OBSERVACIO='None' then '' else OBSERVACIO end OBSERVACIO,LEY,cambrep,Deleted FROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union allSELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[F_EVENTO] solicitada	  ,[HORA]      ,case when evento='MO' then 'ESC099'when evento='US' then 'ESC061'when evento='DC' then 'ESC036'when evento='CO' then 'ESC012'when evento='CP' then 'ESC011'when evento='IP' then 'ESC063'when evento='DS' then 'ESC006'when evento='DO' then 'ESC022'when evento='PU' then 'ESC002'when evento='AP' then 'ESC003'when evento='EO' then 'ESC001'when evento='AI' then 'ESC090'when evento='RR' then 'ESC037'when evento='EL' then 'ESC030'when evento='MA' then 'ESC023'when evento='OT' then 'ESC066'when evento='PE' then 'ESC025'when evento='PP' then 'ESC085'when evento='C1' then 'ESC043'when evento='ST' then 'ESC021'when evento='DP' then 'ESC102'when evento='RM' then 'ESC104'when evento='CE' then 'ESC051'when evento='MS' then 'ESC074'when evento='SP' then 'ESC027'when evento='SC' then 'ESC041'when evento='EM' then 'ESC066'when evento='LE' then 'ESC106'when evento='CL' then 'ESC066'when evento='NU' then 'ESC013'when evento='CC' then 'ESC016'when evento='RH' then 'ESC094'else evento end TIPO_PETI      ,null status_res	  , null stat_desde	  ,null agente	  , null calidad	  ,null quien	  ,null cual	  ,null nro_resol	  ,[COMENTARIO] observacio      ,null ley, null cambrep      ,[DELETED]        FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N' ) aaa  left join HN1.dbo.vw_origin_nuenoms nom on aaa.num_serie=nom.NUM_SERIE left join  HN1.dbo.vw_origin_TITULAR titu on  nom.titular=titu.TITULAR   where aaa.num_serie is not null        )  select   case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq,  cast(doc_ser as numeric(4,0)) USERDOC_SERIES,  cast(doc_nbr as numeric(10,0)) USERDOC_NBR, IND_IMPORT      , USERDOC_TYPE, LAW_CODE, FILING_DATE, RECEPTION_DATE, NOTES, case when PERSON_NAME is null then 'falta capturar nombre' else person_name end person_name  , NATIONALITY_COUNTRY_CODE, RESIDENCE_COUNTRY_CODE      , ADDRESS_STREET, CAPTURE_USER_ID, CAPTURE_DATE from cte 
2019-04-15 09:17:44,521 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'OBSERVACIO'. (102); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'doc_seq'. (102); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'TIPO_PETI'. (102)")
2019-04-15 09:17:44,522 - root - INFO - wrong query:    create  view  dbo.vw_userdoc_files as with cte as (select aaa.[rowNum]      ,[doc_seq]      ,[doc_ser]      ,[doc_nbr]      ,aaa.[NUM_SERIE] 	  ,aaa.[Deleted] 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  	  	  from (SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,deletedFROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union allSELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[DELETED]     FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N' ) aaa  where aaa.num_serie is not null        )    select   pp.nro_solici,pp.file_ser,pp.file_seq,pp.file_nbr, cc.num_serie,  case when cc.doc_seq is not null then case  when rn=1 then cc.DOC_SEQ else cc.doc_seq +'-'+cast(rn as varchar) end   else pp.doc_seq end userdoc_seq,  case when cc.doc_ser is not null then cast(cc.doc_ser as numeric(4,0)) else cast(pp.doc_ser as numeric(4,0)) end USERDOC_SERIES,  case when cc.doc_nbr is not null then cast(cc.doc_nbr as numeric(10,0)) else cast(pp.doc_nbr as numeric(10,0)) end USERDOC_NBR   from cte cc right join (SELECT  rowNum      ,NRO_SOLICI      ,file_ser      ,file_seq      ,file_nbr      ,NUM_SERIE      ,doc_ser      ,doc_seq      ,doc_nbr      FROM dbo.vw_PETIREG ) pp on cc.num_serie=pp.num_serie where cc.deleted='N'running statement    create  view  dbo.vw_userdoc_files as with cte as (select aaa.[rowNum]      ,[doc_seq]      ,[doc_ser]      ,[doc_nbr]      ,aaa.[NUM_SERIE] 	  ,aaa.[Deleted] 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  	  	  from (SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,deletedFROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union allSELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[DELETED]     FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N' ) aaa  where aaa.num_serie is not null        )    select   pp.nro_solici,pp.file_ser,pp.file_seq,pp.file_nbr, cc.num_serie,  case when cc.doc_seq is not null then case  when rn=1 then cc.DOC_SEQ else cc.doc_seq +'-'+cast(rn as varchar) end   else pp.doc_seq end userdoc_seq,  case when cc.doc_ser is not null then cast(cc.doc_ser as numeric(4,0)) else cast(pp.doc_ser as numeric(4,0)) end USERDOC_SERIES,  case when cc.doc_nbr is not null then cast(cc.doc_nbr as numeric(10,0)) else cast(pp.doc_nbr as numeric(10,0)) end USERDOC_NBR   from cte cc right join (SELECT  rowNum      ,NRO_SOLICI      ,file_ser      ,file_seq      ,file_nbr      ,NUM_SERIE      ,doc_ser      ,doc_seq      ,doc_nbr      FROM dbo.vw_PETIREG ) pp on cc.num_serie=pp.num_serie where cc.deleted='N'
2019-04-15 09:17:44,522 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near '.'. (102) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'doc_seq'. (102)")
2019-04-15 09:17:44,522 - root - INFO - wrong query:  /*with cte as (SELECT  rowNum      ,NRO_SOLICI      ,file_ser      ,file_seq      ,file_nbr      ,NUM_SERIE      ,doc_ser      ,doc_seq      ,doc_nbr      ,Deleted	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  FROM dbo.vw_PETIREG)  select jj.USERDOC_SEQ,jj.USERDOC_SERIES,jj.USERDOC_NBR,file_seq      ,file_TYPE,file_series    ,file_nbr from ( select     case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq       ,  cast(doc_ser as numeric) USERDOC_SERIES       ,cast(doc_nbr as numeric) USERDOC_NBR      ,file_seq	  ,'M' FILE_TYPE	  ,cast(file_ser as numeric)  FILE_SERIES    ,cast(file_nbr as numeric) FILE_NBR from cte where num_serie!='0000000000' and isnumeric(file_ser)=1 ) jj running statement  /*with cte as (SELECT  rowNum      ,NRO_SOLICI      ,file_ser      ,file_seq      ,file_nbr      ,NUM_SERIE      ,doc_ser      ,doc_seq      ,doc_nbr      ,Deleted	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  FROM dbo.vw_PETIREG)  select jj.USERDOC_SEQ,jj.USERDOC_SERIES,jj.USERDOC_NBR,file_seq      ,file_TYPE,file_series    ,file_nbr from ( select     case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq       ,  cast(doc_ser as numeric) USERDOC_SERIES       ,cast(doc_nbr as numeric) USERDOC_NBR      ,file_seq	  ,'M' FILE_TYPE	  ,cast(file_ser as numeric)  FILE_SERIES    ,cast(file_nbr as numeric) FILE_NBR from cte where num_serie!='0000000000' and isnumeric(file_ser)=1 ) jj 
2019-04-15 09:17:44,522 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLExecDirectW)")
2019-04-15 09:17:44,523 - root - INFO - wrong query:   */running statement   */
2019-04-15 09:17:44,523 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near '*'. (102) (SQLExecDirectW)")
2019-04-15 09:17:44,524 - root - INFO - wrong query:  create  view  dbo.vw_userdoc_owners as with cte as (SELECT pet.rowNum,cast(doc_ser as numeric(4,0))  doc_ser, doc_seq       , cast(doc_nbr as numeric(10,0))  doc_nbr     ,pet. NUM_SERIE       , 0 as ind_import , TIPO_PETI userdoc_TYPE , 1 as law_code       ,       convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) FILING_DATE      ,'1' ind_service,  convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) RECEPTION_DATE 		,case when isnumeric(NRO_RESOL)=1 then 'Nro. resolucion: '+ NRO_RESOL else '' end +          case when len(observacio)>0 then 'observaciones: '+ cast( OBSERVACIO as varchar(max)) else '' end  notes   , NOMBRE PERSON_NAME ,case when (pais is null or pais='') then 'HN' else  PAIS end NATIONALITY_COUNTRY_CODE ,case when(len( LUGAR)>2 and len(pais)=2 ) then pais when len(lugar)=2 then lugar else 'HN' end RESIDENCE_COUNTRY_CODE ,case when (direccion is null or direccion='') then 'Falta direccion' else  DIRECCION end ADDRESS_STREET ,4 capture_user_id ,getdate() capture_date       , STATUS_RES       , STAT_DESDE       , AGENTE       , CALIDAD       , qUien       , CUAL       , NRO_RESOL       , OBSERVACIO       , LEY       , cambrep       ,pet. Deleted 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)   FROM   dbo.vw_PETICI pet,   HN1.dbo.vw_origin_nuenoms nom ,  HN1.dbo.vw_origin_TITULAR titu     where pet.num_serie is not null and pet.num_serie !='' and len(pet.num_serie)>5   and pet.num_serie=nom.NUM_SERIE and nom.titular=titu.TITULAR)   select jj.userdoc_SEQ,jj.userdoc_SERIES,jj.userdoc_NBR,jj.IND_SERVICE      ,jj.PERSON_NAME      ,jj.NATIONALITY_COUNTRY_CODE      ,jj.RESIDENCE_COUNTRY_CODE      ,jj.ADDRESS_STREET from (select case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq,doc_ser USERDOC_SERIES,doc_nbr USERDOC_NBR      ,IND_SERVICE      ,PERSON_NAME      ,NATIONALITY_COUNTRY_CODE      ,RESIDENCE_COUNTRY_CODE      ,ADDRESS_STREET from  cte ) jj running statement  create  view  dbo.vw_userdoc_owners as with cte as (SELECT pet.rowNum,cast(doc_ser as numeric(4,0))  doc_ser, doc_seq       , cast(doc_nbr as numeric(10,0))  doc_nbr     ,pet. NUM_SERIE       , 0 as ind_import , TIPO_PETI userdoc_TYPE , 1 as law_code       ,       convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) FILING_DATE      ,'1' ind_service,  convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) RECEPTION_DATE 		,case when isnumeric(NRO_RESOL)=1 then 'Nro. resolucion: '+ NRO_RESOL else '' end +          case when len(observacio)>0 then 'observaciones: '+ cast( OBSERVACIO as varchar(max)) else '' end  notes   , NOMBRE PERSON_NAME ,case when (pais is null or pais='') then 'HN' else  PAIS end NATIONALITY_COUNTRY_CODE ,case when(len( LUGAR)>2 and len(pais)=2 ) then pais when len(lugar)=2 then lugar else 'HN' end RESIDENCE_COUNTRY_CODE ,case when (direccion is null or direccion='') then 'Falta direccion' else  DIRECCION end ADDRESS_STREET ,4 capture_user_id ,getdate() capture_date       , STATUS_RES       , STAT_DESDE       , AGENTE       , CALIDAD       , qUien       , CUAL       , NRO_RESOL       , OBSERVACIO       , LEY       , cambrep       ,pet. Deleted 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)   FROM   dbo.vw_PETICI pet,   HN1.dbo.vw_origin_nuenoms nom ,  HN1.dbo.vw_origin_TITULAR titu     where pet.num_serie is not null and pet.num_serie !='' and len(pet.num_serie)>5   and pet.num_serie=nom.NUM_SERIE and nom.titular=titu.TITULAR)   select jj.userdoc_SEQ,jj.userdoc_SERIES,jj.userdoc_NBR,jj.IND_SERVICE      ,jj.PERSON_NAME      ,jj.NATIONALITY_COUNTRY_CODE      ,jj.RESIDENCE_COUNTRY_CODE      ,jj.ADDRESS_STREET from (select case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq,doc_ser USERDOC_SERIES,doc_nbr USERDOC_NBR      ,IND_SERVICE      ,PERSON_NAME      ,NATIONALITY_COUNTRY_CODE      ,RESIDENCE_COUNTRY_CODE      ,ADDRESS_STREET from  cte ) jj 
2019-04-15 09:17:44,524 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'dbo.vw_PETICI'. (208) (SQLExecDirectW)")
2019-04-15 09:17:44,525 - root - INFO - wrong query:   create  view  dbo.vw_userdoc_reprs as with cte as (SELECT pet. rowNum       , cast(doc_ser as numeric(4,0))  doc_ser    , doc_seq       , cast(doc_nbr as numeric(10,0))  doc_nbr     ,pet. NUM_SERIE       , 0 as ind_import , TIPO_PETI userdoc_TYPE , 1 as law_code       ,        convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) FILING_DATE       ,'1' ind_service,    convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) RECEPTION_DATE 	,case when isnumeric(NRO_RESOL)=1 then 'Nro. resolucion: '+ NRO_RESOL else '' end +          case when len(observacio)>0 then 'observaciones: '+ cast( OBSERVACIO as varchar(max)) else '' end  notes   , titu.PERSON_NAME ,titu.NATIONALITY_COUNTRY_CODE ,titu.RESIDENCE_COUNTRY_CODE ,titu.ADDRESS_STREET ,4 capture_user_id ,getdate() capture_date       , STATUS_RES       , STAT_DESDE       , AGENTE       , OBSERVACIO       , LEY       , cambrep       ,pet. Deleted 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)   FROM   dbo.vw_PETICI pet,  dbo.vw_IMPORT_AGENT_PERSONS titu     where pet.num_serie is not null and pet.num_serie !='' and len(pet.num_serie)>5   and AGENTE IS NOT NULL and agente!='' AND ISNUMERIC(AGENTE)=1 AND   CAST(PET.AGENTE AS NUMERIC)=titu.agent_code)  select jj.userdoc_seq,jj.userdoc_series,jj.userdoc_nbr, jj.IND_SERVICE	  ,jj.REPRESENTATIVE_TYPE      ,jj.PERSON_NAME      ,jj.NATIONALITY_COUNTRY_CODE      ,jj.RESIDENCE_COUNTRY_CODE      ,jj.ADDRESS_STREET from (select case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq      ,doc_ser  USERDOC_SERIES      ,doc_nbr  USERDOC_NBR      ,IND_SERVICE	  ,'AG' REPRESENTATIVE_TYPE      ,PERSON_NAME      ,NATIONALITY_COUNTRY_CODE      ,RESIDENCE_COUNTRY_CODE      ,ADDRESS_STREET from  cte ) jj inner join dbo.vw_import_userdoc mm on   jj.USERDOC_SEQ=mm.USERDOC_SEQ and jj.USERDOC_SERIES=mm.USERDOC_SERIES and jj.userdoc_NBR = mm.userdoc_NBRrunning statement   create  view  dbo.vw_userdoc_reprs as with cte as (SELECT pet. rowNum       , cast(doc_ser as numeric(4,0))  doc_ser    , doc_seq       , cast(doc_nbr as numeric(10,0))  doc_nbr     ,pet. NUM_SERIE       , 0 as ind_import , TIPO_PETI userdoc_TYPE , 1 as law_code       ,        convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) FILING_DATE       ,'1' ind_service,    convert(datetime,cast(solicitada as varchar)+' '+case when substring(HORA,1,2)<24 then substring(HORA,1,2) else '00' end+':'+case when substring(HORA,3,2)<60 then substring(HORA,3,2) else '59' end+':'+case  when substring(HORA,5,2)<0 then '00' when substring(HORA,5,2)<60 then substring(HORA,5,2) else '59' end+'.000',120) RECEPTION_DATE 	,case when isnumeric(NRO_RESOL)=1 then 'Nro. resolucion: '+ NRO_RESOL else '' end +          case when len(observacio)>0 then 'observaciones: '+ cast( OBSERVACIO as varchar(max)) else '' end  notes   , titu.PERSON_NAME ,titu.NATIONALITY_COUNTRY_CODE ,titu.RESIDENCE_COUNTRY_CODE ,titu.ADDRESS_STREET ,4 capture_user_id ,getdate() capture_date       , STATUS_RES       , STAT_DESDE       , AGENTE       , OBSERVACIO       , LEY       , cambrep       ,pet. Deleted 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)   FROM   dbo.vw_PETICI pet,  dbo.vw_IMPORT_AGENT_PERSONS titu     where pet.num_serie is not null and pet.num_serie !='' and len(pet.num_serie)>5   and AGENTE IS NOT NULL and agente!='' AND ISNUMERIC(AGENTE)=1 AND   CAST(PET.AGENTE AS NUMERIC)=titu.agent_code)  select jj.userdoc_seq,jj.userdoc_series,jj.userdoc_nbr, jj.IND_SERVICE	  ,jj.REPRESENTATIVE_TYPE      ,jj.PERSON_NAME      ,jj.NATIONALITY_COUNTRY_CODE      ,jj.RESIDENCE_COUNTRY_CODE      ,jj.ADDRESS_STREET from (select case when rn=1 then DOC_SEQ else doc_seq +'-'+cast(rn as varchar) end userdoc_seq      ,doc_ser  USERDOC_SERIES      ,doc_nbr  USERDOC_NBR      ,IND_SERVICE	  ,'AG' REPRESENTATIVE_TYPE      ,PERSON_NAME      ,NATIONALITY_COUNTRY_CODE      ,RESIDENCE_COUNTRY_CODE      ,ADDRESS_STREET from  cte ) jj inner join dbo.vw_import_userdoc mm on   jj.USERDOC_SEQ=mm.USERDOC_SEQ and jj.USERDOC_SERIES=mm.USERDOC_SERIES and jj.userdoc_NBR = mm.userdoc_NBR
2019-04-15 09:17:44,526 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'dbo.vw_PETICI'. (208) (SQLExecDirectW)")
2019-04-15 09:17:44,527 - root - INFO - wrong query:         create  view  dbo.vw_MOVIMI_USERDOC as select aaa.rowNum,aaa.userdoc_seq,aaa.userdoc_series,aaa.userdoc_nbr,N_ENTRADA,ACTION_DATE,ACTION_TYPE,RESPONSIBLE_USER,ACTION_NOTES1,ACTION_NOTES2,ACTION_USER,ACTION_CATERY from (select movi.rowNum,case when (ISNUMERIC(movi.N_ENTRADA)=0) then right(movi.N_ENTRADA,1) else 'M' end userdoc_seq,convert(numeric,case when isnumeric(left(movi.N_ENTRADA,4))=1 then left(movi.N_ENTRADA,4) else '1' end) userdoc_series,cast(case when (ISNUMERIC(movi.N_ENTRADA)=0) then substring(movi.N_ENTRADA,5,len(movi.N_ENTRADA)-5) else substring(movi.N_ENTRADA,5,len(movi.N_ENTRADA)-4) end as numeric )  userdoc_nbr , movi.N_ENTRADA,evento ACTION_TYPE, action_date_ipas ACTION_DATE,case when us.rowNum is not null then us.rowNum else null end RESPONSIBLE_USER,case when COMENTARIO='None' then '' else COMENTARIO end ACTION_NOTES1, case when documento is not null and documento !='' then 'Refiere a documento: '+ DOCUMENTO else '' end ACTION_NOTES2 ,case when us.rowNum is not null then us.rowNum else '4' end ACTION_USER ,'N' ACTION_CATERY  FROM dbo.vw_origin_movimi movi  left join dbo.vw_origin_users us on movi.USUARIO=us.CODE_USER   where   ISNUMERIC(n_entrada)=1 and  action_date_ipas is not null and movi.N_ENTRADA is not null and movi.evento is not null ) aaa   inner join dbo.vw_userdoc ud on aaa.userdoc_seq = ud.userdoc_seq and aaa.userdoc_series=ud.USERDOC_SERIES and aaa.userdoc_nbr=ud.USERDOC_NBR  running statement         create  view  dbo.vw_MOVIMI_USERDOC as select aaa.rowNum,aaa.userdoc_seq,aaa.userdoc_series,aaa.userdoc_nbr,N_ENTRADA,ACTION_DATE,ACTION_TYPE,RESPONSIBLE_USER,ACTION_NOTES1,ACTION_NOTES2,ACTION_USER,ACTION_CATERY from (select movi.rowNum,case when (ISNUMERIC(movi.N_ENTRADA)=0) then right(movi.N_ENTRADA,1) else 'M' end userdoc_seq,convert(numeric,case when isnumeric(left(movi.N_ENTRADA,4))=1 then left(movi.N_ENTRADA,4) else '1' end) userdoc_series,cast(case when (ISNUMERIC(movi.N_ENTRADA)=0) then substring(movi.N_ENTRADA,5,len(movi.N_ENTRADA)-5) else substring(movi.N_ENTRADA,5,len(movi.N_ENTRADA)-4) end as numeric )  userdoc_nbr , movi.N_ENTRADA,evento ACTION_TYPE, action_date_ipas ACTION_DATE,case when us.rowNum is not null then us.rowNum else null end RESPONSIBLE_USER,case when COMENTARIO='None' then '' else COMENTARIO end ACTION_NOTES1, case when documento is not null and documento !='' then 'Refiere a documento: '+ DOCUMENTO else '' end ACTION_NOTES2 ,case when us.rowNum is not null then us.rowNum else '4' end ACTION_USER ,'N' ACTION_CATERY  FROM dbo.vw_origin_movimi movi  left join dbo.vw_origin_users us on movi.USUARIO=us.CODE_USER   where   ISNUMERIC(n_entrada)=1 and  action_date_ipas is not null and movi.N_ENTRADA is not null and movi.evento is not null ) aaa   inner join dbo.vw_userdoc ud on aaa.userdoc_seq = ud.userdoc_seq and aaa.userdoc_series=ud.USERDOC_SERIES and aaa.userdoc_nbr=ud.USERDOC_NBR  
2019-04-15 09:17:44,527 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'dbo.vw_userdoc'. (208) (SQLExecDirectW)")
