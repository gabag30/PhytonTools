2019-04-09 16:24:07,542 - root - WARNING - connected to Sqlserver.
2019-04-09 16:24:07,543 - root - WARNING - Regenerating intermediate tables.
2019-04-09 16:24:07,740 - root - WARNING - creating views.
2019-04-09 16:24:07,752 - root - INFO - wrong query:     create view dbo.vw_TITUMAR as select aaa.FILE_SEQ,aaa.FILE_TYPE,aaa.FILE_SERIES,aaa.FILE_NBR,ind_service,PERSON_NAME,ADDRESS_STREET,NATIONALITY_COUNTRY_CODE,RESIDENCE_COUNTRY_CODE from(select aaa.FILE_SEQ,aaa.FILE_TYPE,aaa.FILE_SERIES,aaa.FILE_NBR,ind_service,PERSON_NAME,ADDRESS_STREET,NATIONALITY_COUNTRY_CODE,RESIDENCE_COUNTRY_CODE from(  SELECT cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ, 'M' FILE_TYPE,   cast(left(nro_solici,4)  as numeric (4,0)) FILE_SERIES,    cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0)) FILE_NBR,'1' ind_service,NOMBRE PERSON_NAME,case when (direccion is null or direccion='') then 'Falta direccion' else DIRECCION end ADDRESS_STREET,case when (pais is null or pais='') then 'HN' else PAIS end NATIONALITY_COUNTRY_CODE,case when(len(LUGAR)>2 and len(pais)=2 ) then pais when len(lugar)=2 then lugar else 'HN' end RESIDENCE_COUNTRY_CODE FROM HN1.dbo.vw_origin_titumar ori, HN1.dbo.vw_origin_TITULAR titu  where ori.deleted='N' and ori.titular=titu.TITULAR and nro_solici is not null and nro_solici!='' and len(replace(nro_solici,' ',''))>6 and isnumeric(left(nro_solici,1))=1and len(NRO_SOLICI)>6 ) aaa  inner join dbo.vw_import_MARK mm on   aaa.FILE_SEQ=mm.FILE_SEQ and aaa.FILE_TYPE=mm.FILE_TYPE and aaa.FILE_SERIES=mm.FILE_SERIES and aaa.FILE_NBR = mm.FILE_NBRrunning statement     create view dbo.vw_TITUMAR as select aaa.FILE_SEQ,aaa.FILE_TYPE,aaa.FILE_SERIES,aaa.FILE_NBR,ind_service,PERSON_NAME,ADDRESS_STREET,NATIONALITY_COUNTRY_CODE,RESIDENCE_COUNTRY_CODE from(select aaa.FILE_SEQ,aaa.FILE_TYPE,aaa.FILE_SERIES,aaa.FILE_NBR,ind_service,PERSON_NAME,ADDRESS_STREET,NATIONALITY_COUNTRY_CODE,RESIDENCE_COUNTRY_CODE from(  SELECT cast(case when ISNUMERIC(nro_solici)= 0 then right(NRO_SOLICI,1) else '1'  end as varchar) FILE_SEQ, 'M' FILE_TYPE,   cast(left(nro_solici,4)  as numeric (4,0)) FILE_SERIES,    cast(substring(NRO_SOLICI,5,len(NRO_SOLICI)-(case when ISNUMERIC(nro_solici)=0 then 5 else 4 end)  ) as numeric(10,0)) FILE_NBR,'1' ind_service,NOMBRE PERSON_NAME,case when (direccion is null or direccion='') then 'Falta direccion' else DIRECCION end ADDRESS_STREET,case when (pais is null or pais='') then 'HN' else PAIS end NATIONALITY_COUNTRY_CODE,case when(len(LUGAR)>2 and len(pais)=2 ) then pais when len(lugar)=2 then lugar else 'HN' end RESIDENCE_COUNTRY_CODE FROM HN1.dbo.vw_origin_titumar ori, HN1.dbo.vw_origin_TITULAR titu  where ori.deleted='N' and ori.titular=titu.TITULAR and nro_solici is not null and nro_solici!='' and len(replace(nro_solici,' ',''))>6 and isnumeric(left(nro_solici,1))=1and len(NRO_SOLICI)>6 ) aaa  inner join dbo.vw_import_MARK mm on   aaa.FILE_SEQ=mm.FILE_SEQ and aaa.FILE_TYPE=mm.FILE_TYPE and aaa.FILE_SERIES=mm.FILE_SERIES and aaa.FILE_NBR = mm.FILE_NBR
2019-04-09 16:24:07,752 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'FILE_NBR'. (102) (SQLExecDirectW)")
2019-04-09 16:24:07,769 - root - WARNING - connected to Sqlserver.
2019-04-09 16:24:07,770 - root - WARNING - starting migration to intermed.
2019-04-09 16:24:07,770 - root - WARNING - Going to insert to table: HN1.dbo.VW_IMPORT_AGENT
2019-04-09 16:24:09,694 - root - WARNING - Going to insert to table: HN1.dbo.VW_IMPORT_AGENT_PERSONS
