2019-04-15 09:22:58,363 - root - WARNING - connected to Sqlserver.
2019-04-15 09:22:58,368 - root - WARNING - Updating original tables with correction script.
2019-04-15 09:22:58,431 - root - INFO - From SQLCMD: b'Msg 102, Level 15, State 1, Server WS538539, Line 1\r\n'
2019-04-15 09:22:58,432 - root - INFO - From SQLCMD: b"Incorrect syntax near '\\'.\r\n"
2019-04-15 09:22:58,440 - root - WARNING - Updating orignal tables with additional correction.
2019-04-15 09:23:08,089 - root - WARNING - Regenerating intermediate tables.
2019-04-15 09:23:08,286 - root - WARNING - creating views.
2019-04-15 09:23:08,306 - root - INFO - wrong query:    create  view  dbo.vw_userdoc_files as with cte as (select aaa.[rowNum]      ,[doc_seq]      ,[doc_ser]      ,[doc_nbr]      ,aaa.[NUM_SERIE] 	  ,aaa.[Deleted] 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  	  	  from (SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,deletedFROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union all SELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[DELETED]     FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N' ) aaa  where aaa.num_serie is not null        )    select   pp.nro_solici,pp.file_ser,pp.file_seq,pp.file_nbr, cc.num_serie,  case when cc.doc_seq is not null then case  when rn=1 then cc.DOC_SEQ else cc.doc_seq +'-'+cast(rn as varchar) end   else pp.doc_seq end userdoc_seq,  case when cc.doc_ser is not null then cast(cc.doc_ser as numeric(4,0)) else cast(pp.doc_ser as numeric(4,0)) end USERDOC_SERIES,  case when cc.doc_nbr is not null then cast(cc.doc_nbr as numeric(10,0)) else cast(pp.doc_nbr as numeric(10,0)) end USERDOC_NBR   from cte cc right join (SELECT  rowNum      ,NRO_SOLICI      ,file_ser      ,file_seq      ,file_nbr      ,NUM_SERIE      ,doc_ser      ,doc_seq      ,doc_nbr      FROM dbo.vw_PETIREG ) pp on cc.num_serie=pp.num_serie where cc.deleted='N'running statement    create  view  dbo.vw_userdoc_files as with cte as (select aaa.[rowNum]      ,[doc_seq]      ,[doc_ser]      ,[doc_nbr]      ,aaa.[NUM_SERIE] 	  ,aaa.[Deleted] 	  ,RN = ROW_NUMBER()OVER(PARTITION BY doc_seq,doc_ser,doc_nbr ORDER BY doc_ser,doc_nbr)  	  	  from (SELECT  rowNum,case when (ISNUMERIC(num_serie)=0) then right(num_serie,1) else 'M' end doc_seq,cast(left(num_serie,4) as numeric(4,0)) doc_ser, cast(case when (ISNUMERIC(num_serie)=0) then substring(num_serie,5,len(num_serie)-5) else substring(num_serie,5,len(num_serie)-4)  end as numeric(10,0)) doc_nbr,NUM_SERIE,deletedFROM HN1.dbo.vw_origin_peticion where len(num_serie)>=4 and TIPO_PETI in ('RN','FU','LU','TR','CN','CD','NU','CC','RH')union all SELECT  [rowNum],	case when (ISNUMERIC(documento)=0) then right(documento,1) else 'M' end doc_seq,	cast(left(documento,4) as numeric(4,0)) doc_ser, 	cast( substring(documento,5,len(documento)-4) as numeric(10,0)) doc_nbr,	documento num_serie      ,[DELETED]     FROM dbo.vw_origin_movimi where evento in ('MO','US','DC','CO',  'CP','IP','DS','DO','PU','AP','EO','AI','RR','EL','MA','OT','PE','PP','C1','ST','DP','RM','CE','MS','SP','SC','EM','LE','CL')  and documento is not null and len(documento)>4 and isnumeric(documento)=1 and deleted='N' ) aaa  where aaa.num_serie is not null        )    select   pp.nro_solici,pp.file_ser,pp.file_seq,pp.file_nbr, cc.num_serie,  case when cc.doc_seq is not null then case  when rn=1 then cc.DOC_SEQ else cc.doc_seq +'-'+cast(rn as varchar) end   else pp.doc_seq end userdoc_seq,  case when cc.doc_ser is not null then cast(cc.doc_ser as numeric(4,0)) else cast(pp.doc_ser as numeric(4,0)) end USERDOC_SERIES,  case when cc.doc_nbr is not null then cast(cc.doc_nbr as numeric(10,0)) else cast(pp.doc_nbr as numeric(10,0)) end USERDOC_NBR   from cte cc right join (SELECT  rowNum      ,NRO_SOLICI      ,file_ser      ,file_seq      ,file_nbr      ,NUM_SERIE      ,doc_ser      ,doc_seq      ,doc_nbr      FROM dbo.vw_PETIREG ) pp on cc.num_serie=pp.num_serie where cc.deleted='N'
2019-04-15 09:23:08,306 - root - ERROR - >>>>>>>>>>>>>>> issue with insert query ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near '.'. (102) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102)")
