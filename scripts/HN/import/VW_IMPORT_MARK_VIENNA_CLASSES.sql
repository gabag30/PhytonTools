--FIELDS FILE_SEQ, FILE_TYPE, FILE_SERIES, FILE_NBR, VIENNA_EDITION_CODE, VIENNA_CATEGORY, VIENNA_DIVISION, VIENNA_SECTION;;
--QUERY
 select mm.file_SEQ, mm.FILE_TYPE, mm.FILE_SERIES, mm.file_NBR,VIENNA_EDITION_CODE, VIENNA_CATEGORY, VIENNA_DIVISION ,VIENNA_SECTION from (SELECT  file_SEQ, FILE_TYPE, FILE_SERIES, file_NBR,	  cast(0 as numeric) VIENNA_EDITION_CODE,cast(substring(replace(replace(ccv,' ',''),'.',''),1,2) as numeric) VIENNA_CATEGORY   ,cast(case when substring(replace(replace(ccv,' ',''),'.',''),3,2) is null or substring(replace(replace(ccv,' ',''),'.',''),3,2)='' then 1 else substring(replace(replace(ccv,' ',''),'.',''),3,2) end as numeric)  VIENNA_DIVISION   ,cast(case when isnumeric(substring(replace(replace(ccv,' ',''),'.',''),5,2))=0 then null else substring(replace(replace(ccv,' ',''),'.',''),5,2) end as numeric)   VIENNA_SECTION  FROM vw_origin_ccvs cc, vw_marcas2 mm where cc.NRO_SOLICI=mm.NRO_SOLICI AND CCV is not null) mm inner join vw_import_mark aa on mm.file_seq=aa.file_seq and mm.file_type=aa.file_type and mm.file_series=aa.file_series and mm.file_nbr=aa.file_nbr;;
